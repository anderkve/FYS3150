
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Project 5 &#8212; FYS3150/FYS4150 course material</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Project 4" href="project4.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">FYS3150/FYS4150 course material</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting ready
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_ready/windows_users.html">
   Windows users
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_ready/mac_users.html">
   Mac users
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_ready/linux_users.html">
   Linux users
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Using the terminal
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../using_the_terminal/basics.html">
   Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_the_terminal/keyboard_shortcuts.html">
   Keyboard shortcuts
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Using Git and GitHub
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/introduction_to_git.html">
   Introduction to Git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/setting_up_git_and_a_GitHub_repo.html">
   Setting up Git and a GitHub repository
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/add_a_README_and_gitignore.html">
   Add a README and gitignore
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/using_git.html">
   Using Git
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/dealing_with_merge_conflicts.html">
   Dealing with merge conflicts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/recover_an_old_version_of_a_file.html">
   Recover an old version of a file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/other_ways_to_fix_mistakes.html">
   Other ways to fix mistakes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../using_git/online_resources.html">
   Online git resources
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to C++
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/intro.html">
   Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/hello_world.html">
   Hello World
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/compiling_and_linking_take_1.html">
   Compiling and linking, take 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/source_files_and_header_files.html">
   Source files and header files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/variables.html">
   Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/functions_take_1.html">
   Functions, take 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/read_command_line_input.html">
   Read command line input
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/write_to_file.html">
   Write to file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/read_from_file.html">
   Read from file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/if_else.html">
   If else
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/loops.html">
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/containers.html">
   Containers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/intro_to_armadillo.html">
   Introduction to Armadillo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/pointers.html">
   Pointers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/classes.html">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction_to_cpp/online_resources.html">
   Online C++ resources
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../optimization/memory_is_the_bottleneck.html">
   Memory traffic is the bottleneck
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Parallelization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../parallelization/introduction_to_openmp.html">
   Introduction to OpenMP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../parallelization/using_openmp.html">
   Using OpenMP
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Using Make
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../using_make/intro.html">
   Intro
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Writing reports
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../writing_reports/introduction_to_latex.html">
   Introduction to LaTeX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../writing_reports/checklist.html">
   Checklist for reports
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="project1.html">
   Project 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project2.html">
   Project 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project3.html">
   Project 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project4.html">
   Project 4
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Project 5
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/anderkve/FYS3150"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/anderkve/FYS3150/issues/new?title=Issue%20on%20page%20%2Fbook/projects/project5.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/book/projects/project5.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicalities">
   Practicalities
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-schrodinger-equation">
   The Schrödinger equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notation">
   Notation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-and-boundary-conditions">
   Initial and boundary conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problems">
   Problems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-0">
     Problem 0
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-1">
     Problem 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-2">
     Problem 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3">
     Problem 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-4">
     Problem 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-5">
     Problem 5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-6">
     Problem 6
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-7">
     Problem 7
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-8">
     Problem 8
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-9">
     Problem 9
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-x">
     Problem X
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-snippets">
     Code snippets
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Project 5</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicalities">
   Practicalities
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-schrodinger-equation">
   The Schrödinger equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notation">
   Notation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-and-boundary-conditions">
   Initial and boundary conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problems">
   Problems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-0">
     Problem 0
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-1">
     Problem 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-2">
     Problem 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3">
     Problem 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-4">
     Problem 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-5">
     Problem 5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-6">
     Problem 6
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-7">
     Problem 7
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-8">
     Problem 8
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-9">
     Problem 9
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-x">
     Problem X
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-snippets">
     Code snippets
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="project-5">
<h1>Project 5<a class="headerlink" href="#project-5" title="Permalink to this headline">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure to check this page regularly for small updates, typo fixes and hints.</p>
</div>
<section id="practicalities">
<h2>Practicalities<a class="headerlink" href="#practicalities" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Deadline</strong>: Tuesday, December 13, 23:59.</p></li>
<li><p><strong>Format:</strong></p>
<ul>
<li><p>A scientific report, typeset in LaTeX, delivered as a pdf file on Canvas.</p></li>
<li><p>Code (with comments, of course) on a GitHub repo, with the repo link provided in your report.</p></li>
<li><p>You <em>must</em> deliver via your group on Canvas (even if you are working alone).</p></li>
</ul>
</li>
<li><p><strong>Collaboration:</strong> We strongly encourage you to collaborate with others, in groups of up to four students. The group hands in a single pdf. Remember to list everyone’s name in the pdf.</p></li>
<li><p><strong>Reproducibility:</strong> Your code should be available on a GitHub repo. You can refer to relevant parts of your code in your answers. Make sure to include a README file in the repo that briefly explains how the code is organized, and how it should be compiled and run in order for others to reproduce your results.</p></li>
<li><p><strong>Figures:</strong> Figures included in your LaTeX document should preferrably be made as vector graphics (e.g. <code class="docutils literal notranslate"><span class="pre">.pdf</span></code> files), rather than raster graphics (e.g. <code class="docutils literal notranslate"><span class="pre">.png</span></code> files).</p></li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>The goal of this project is to simulate the two-dimensional time-dependent Schrödinger equation, and use it to study a double-slit-in-a-box setup and variations thereof. In short, you will write a simulation that can give results <a class="reference external" href="https://www.dropbox.com/s/76sdq2ecp0ekiin/animation.mp4?dl=0"><code class="docutils literal notranslate"><span class="pre">like</span> <span class="pre">this</span></code></a>. (Note that you will not be required to animate your results, but it’s quite instructive and fun to do so.)</p>
<p>The key methodological aspects of the projects are:</p>
<ul class="simple">
<li><p>Understanding partial differential equations (PDEs)</p></li>
<li><p>Applying the Crank-Nicolson method in 2+1 dimensions</p></li>
<li><p>Working with complex numbers in code</p></li>
<li><p>Getting them indices straight…</p></li>
<li><p>Using conserved quantities as stability checks</p></li>
</ul>
</section>
<section id="the-schrodinger-equation">
<h2>The Schrödinger equation<a class="headerlink" href="#the-schrodinger-equation" title="Permalink to this headline">#</a></h2>
<p>The general formulation of the time-dependent Schrödinger equation is</p>
<div class="math notranslate nohighlight">
\[
i \hbar \frac{d}{dt} |\Psi\rangle = \hat{H} |\Psi\rangle,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{H}\)</span> is some Hamiltonian operator and <span class="math notranslate nohighlight">\(|\Psi\rangle\)</span> is the quantum state (<a class="reference external" href="https://plato.stanford.edu/entries/qt-issues/#OntoIssu">whatever that is</a>). While we’re not really sure what the quantum state <em>is</em>, we do know it is related to probability (<a class="reference external" href="https://plato.stanford.edu/entries/probability-interpret/">whatever that is</a>) through the <a class="reference external" href="https://en.wikipedia.org/wiki/Born_rule">Born rule</a>, which we will use extensively in this project. More details below.</p>
<p>We will now consider the case of <em>a single, non-relativistic particle in two dimensions</em>. If we work in “position space”, the quantum state <span class="math notranslate nohighlight">\(|\Psi\rangle\)</span> can then be expressed through a <em>complex-valued</em> function <span class="math notranslate nohighlight">\(\Psi(x,y,t)\)</span>, historically called the <em>the wave function</em>. The Schrödinger equation then becomes</p>
<div class="math notranslate nohighlight">
\[
i \hbar \frac{\partial}{\partial t} \Psi(x,y,t) = -\frac{\hbar^2}{2m} \left( \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} \right) \Psi(x,y,t) + V(x,y,t) \Psi(x,y,t).
\]</div>
<p>Here the terms <span class="math notranslate nohighlight">\(-\frac{\hbar^2}{2m} \frac{\partial^2 \Psi}{\partial x^2}\)</span> and <span class="math notranslate nohighlight">\(-\frac{\hbar^2}{2m} \frac{\partial^2 \Psi}{\partial y^2}\)</span> are expressions of the kinetic energy, corresponding to <span class="math notranslate nohighlight">\(\frac{p^2}{2m}\)</span> from classical physics, with <span class="math notranslate nohighlight">\(m\)</span> being the particle mass. The external environment is encoded in <em>the potential</em> <span class="math notranslate nohighlight">\(V\)</span>. We will only consider the case of a <em>time-independent</em> potential, <span class="math notranslate nohighlight">\(V = V(x,y)\)</span>.</p>
<p>When working in position space like this, the Born rule takes the form</p>
<div class="math notranslate nohighlight">
\[
p(x,y\,;t) = |\Psi(x,y,t)|^2 = \Psi^*(x,y,t) \, \Psi(x,y,t),
\]</div>
<p>where <span class="math notranslate nohighlight">\(p(x,y\,;t)\)</span> denotes the probability density for detecting the particle at position <span class="math notranslate nohighlight">\((x,y)\)</span> if we perform a position measurement at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>To keep things simple, we will in this project assume that all dimensionful variables have been scaled away, leaving us with a “bare” Schrödinger equation on the form</p>
<div class="math notranslate nohighlight" id="equation-schr-eq">
<span class="eqno">(24)<a class="headerlink" href="#equation-schr-eq" title="Permalink to this equation">#</a></span>\[
i \frac{\partial u}{\partial t} = -\frac{\partial^2 u}{\partial x^2} - \frac{\partial^2 u}{\partial y^2} + v(x,y) u.
\]</div>
<p>So in this equation <em>all the variables are dimensionless</em>, which means you do not have to worry about units for this project. Our goal is to solve equation <a class="reference internal" href="#equation-schr-eq">(24)</a> numerically to determine the evolution of the “wave function” <span class="math notranslate nohighlight">\(u(x,y,t)\)</span> in the presence of some potential <span class="math notranslate nohighlight">\(v(x,y)\)</span>.</p>
<p>In our new notation the Born rule takes the form</p>
<div class="math notranslate nohighlight">
\[
p(x,y;t) = |u(x,y,t)|^2 = u^*(x,y,t) \, u(x,y,t).
\]</div>
<p>assuming the wave function <span class="math notranslate nohighlight">\(u(x,y,t)\)</span> has been properly normalized.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this course we don’t expect any background knowledge in quantum mechanics, so you are not expected to discuss a lot of quantum mechanics in your report. That is, you can simply view the Schrödinger equation as a particular type of differential equation given by equation <a class="reference internal" href="#equation-schr-eq">(24)</a>, where the solution is some complex-valued function <span class="math notranslate nohighlight">\(u(x,y,t)\)</span>, and where we have a rule for connecting this <span class="math notranslate nohighlight">\(u(x,y,t)\)</span> to a probability distribution.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>For those with some quantum mechanics background:</em> A question that sometimes come up during this project is how the wave function <span class="math notranslate nohighlight">\(\Psi(x,y,t)\)</span> actually is related to the state <span class="math notranslate nohighlight">\(|\Psi\rangle\)</span>, so here’s a short answer. (Again, you are not expected to discuss any of this in your reports.)</p>
<p>Consider the one-dimensional case and for simplicity assume that we have discretized time and space (notation <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(t_n\)</span>). To work in position space we can express <span class="math notranslate nohighlight">\(|\Psi\rangle\)</span> in terms of a set of orthonormal basis states <span class="math notranslate nohighlight">\(|x_i\rangle\)</span>. (These are eigenstates of the position operator, <span class="math notranslate nohighlight">\(\hat{X} |x_i \rangle = x_i |x_i\rangle\)</span>). In doing this, the now-discretized wavefunction <span class="math notranslate nohighlight">\(\Psi(x_i,t_n) \equiv \Psi_i^n\)</span> simply corresponds to the complex coefficients in this way of expressing <span class="math notranslate nohighlight">\(|\Psi\rangle\)</span>:</p>
<div class="math notranslate nohighlight">
\[
|\Psi\rangle = \Psi_1^n |x_1 \rangle + \Psi_2^n |x_2 \rangle + \Psi_3^n |x_3 \rangle + \ldots,
\]</div>
<p>and correspondingly</p>
<div class="math notranslate nohighlight">
\[
\langle \Psi| =  \langle x_1 | \Psi^{n*}_1 + \langle x_2 | \Psi^{n*}_2 + \langle x_3 | \Psi^{n*}_3 \ldots
\]</div>
<p>Since the states <span class="math notranslate nohighlight">\(|x_i\rangle\)</span> are orthonormal, i.e. <span class="math notranslate nohighlight">\(\langle x_i|x_j\rangle = \delta_{ij}\)</span>, we have that the wavefunction value for position <span class="math notranslate nohighlight">\(x_i\)</span> and time <span class="math notranslate nohighlight">\(t_n\)</span> can be viewed as the overlap between the current state <span class="math notranslate nohighlight">\(|\Psi\rangle\)</span> and the basis state <span class="math notranslate nohighlight">\(|x_i\rangle\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\langle x_i | \Psi \rangle = \Psi_i^n.
\]</div>
<p>Assuming that we make a position measurement at time <span class="math notranslate nohighlight">\(t_n\)</span>, the probability <span class="math notranslate nohighlight">\(P(x_i;t_n)\)</span> (not probability density, since we now work with discretized space) that the outcome will be <span class="math notranslate nohighlight">\(x_i\)</span> can be expressed as</p>
<div class="math notranslate nohighlight">
\[
P(x_i;t_n) = | \langle x_i | \Psi \rangle |^2 = |\Psi_i^n|^2 = \Psi^{n*}_i \, \Psi^n_i.
\]</div>
<p>In this notation, the normalization condition for the total probability can be viewed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
1 &amp;= \langle \Psi | \Psi \rangle\\ 
  &amp;= \big[ \langle x_1 | \Psi^{n*}_1 + \langle x_2 | \Psi^{n*}_2 + \ldots \big] \; \big[ \Psi^n_1 |x_1 \rangle + \Psi^n_2 |x_2 \rangle + \ldots \big]\\ 
  &amp;= \Psi^{n*}_1 \, \Psi^n_1 + \Psi^{n*}_2 \, \Psi^n_2 + \ldots \\
  &amp;= P(x_1;t) + P(x_2;t) + \ldots
\end{split}\]</div>
</div>
</section>
<section id="notation">
<h2>Notation<a class="headerlink" href="#notation" title="Permalink to this headline">#</a></h2>
<p>Below we define the basic notation we will use for this project.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x \in [0,1]\)</span>, <span class="math notranslate nohighlight">\(y \in [0,1]\)</span>, <span class="math notranslate nohighlight">\(t \in [0,T]\)</span>.</p></li>
<li><p>We’ll use an equal step size <span class="math notranslate nohighlight">\(h\)</span> in both the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions.</p></li>
<li><p><span class="math notranslate nohighlight">\(x \rightarrow x_i = i h\)</span>, with <span class="math notranslate nohighlight">\(i = 0, 1, \ldots, M-1\)</span>. (Don’t confuse this index <span class="math notranslate nohighlight">\(i\)</span> with the imaginary unit <span class="math notranslate nohighlight">\(i\)</span> appearing in the Schrödinger equation!)</p></li>
<li><p><span class="math notranslate nohighlight">\(y \rightarrow y_j = j h\)</span>, with <span class="math notranslate nohighlight">\(j = 0, 1, \ldots, M-1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(t \rightarrow t_n = n \Delta t\)</span>, with <span class="math notranslate nohighlight">\(n = 0, 1, \ldots, N_t-1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(u(x,y,t) \rightarrow u(ih,jh,n \Delta t) \equiv u_{ij}^n\)</span>. Note that the superscript <span class="math notranslate nohighlight">\(n\)</span> here is simply a time index — we have not raised <span class="math notranslate nohighlight">\(u_{ij}\)</span> to the <span class="math notranslate nohighlight">\(n\)</span>-th power!</p></li>
<li><p>The matrix <span class="math notranslate nohighlight">\(U^n\)</span> is a matrix with elements <span class="math notranslate nohighlight">\(u_{ij}^n\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(v(x,y) \rightarrow v(ih,jh) \equiv v_{ij}\)</span>.</p></li>
<li><p>The matrix <span class="math notranslate nohighlight">\(V\)</span> is a matrix with elements <span class="math notranslate nohighlight">\(v_{ij}\)</span>.</p></li>
</ul>
<p>Note:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(M\)</span> is the number of <em>points</em> along the <span class="math notranslate nohighlight">\(x\)</span> axis, including the boundary points. Thus, the <span class="math notranslate nohighlight">\(x\)</span> axis has been discretized using <span class="math notranslate nohighlight">\(M-1\)</span> <em>steps</em>, and there are <span class="math notranslate nohighlight">\(M-2\)</span> “internal points” <span class="math notranslate nohighlight">\(x_1, \ldots, x_{M-2}\)</span>, i.e. excluding the boundary points <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_{M-1}\)</span>.</p></li>
<li><p>Similarly for the <span class="math notranslate nohighlight">\(y\)</span> axis, again with <span class="math notranslate nohighlight">\(M\)</span> being the number of <em>points</em>.</p></li>
<li><p>We will mix index notation with and without commas as needed for clarity. So keep in mind that e.g. <span class="math notranslate nohighlight">\(u_{ij}\)</span> and <span class="math notranslate nohighlight">\(u_{i,j}\)</span> mean the same thing.</p></li>
</ul>
</section>
<section id="initial-and-boundary-conditions">
<h2>Initial and boundary conditions<a class="headerlink" href="#initial-and-boundary-conditions" title="Permalink to this headline">#</a></h2>
<p>Throughout this project we will assume Dirichlet boundary conditions in the <span class="math notranslate nohighlight">\(xy\)</span> plane:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(u(x=0, y, t) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u(x=1, y, t) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u(x, y=0, t) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(u(x, y=1, t) = 0\)</span></p></li>
</ul>
<p>This assumption simplifies the implemention of the Crank-Nicolson scheme quite a bit, so keep in mind that the code we write will have this assumption baked in from the beginning.</p>
<p>For the initial wave function <span class="math notranslate nohighlight">\(u(x,y,t=0)\)</span> we will typically use a quantum mechanical Gaussian wavepacket, to be specified in the problems below.</p>
</section>
<section id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">#</a></h2>
<section id="problem-0">
<h3>Problem 0<a class="headerlink" href="#problem-0" title="Permalink to this headline">#</a></h3>
<p>Not really a problem but an advice: Before diving into this project, take a look at the <a class="reference external" href="http://arma.sourceforge.net/docs.html">Armadillo documentation</a> to see how you can work with complex numbers. For instance, look up terms like <code class="docutils literal notranslate"><span class="pre">cx_double</span></code>, <code class="docutils literal notranslate"><span class="pre">cx_vec</span></code>, <code class="docutils literal notranslate"><span class="pre">cx_mat</span></code>, etc.</p>
<p>In practice, this simply means having your Armadillo objects filled with the standard <code class="docutils literal notranslate"><span class="pre">std::complex&lt;double&gt;</span></code> type in C++. You should read about that <a class="reference external" href="https://en.cppreference.com/w/cpp/numeric/complex">here</a> and take a look at the examples.</p>
<p>PS: You might also find <code class="docutils literal notranslate"><span class="pre">sp_cx_mat</span></code> in Armadillo very useful at some point…</p>
</section>
<section id="problem-1">
<h3>Problem 1<a class="headerlink" href="#problem-1" title="Permalink to this headline">#</a></h3>
<p>Show analytically that by discretizing equation <a class="reference internal" href="#equation-schr-eq">(24)</a> according to the Crank-Nicolson approach, you end up with the expression</p>
<div class="math notranslate nohighlight" id="equation-cn-eq1">
<span class="eqno">(25)<a class="headerlink" href="#equation-cn-eq1" title="Permalink to this equation">#</a></span>\[\begin{split}
u_{ij}^{n+1}  -  r \left[u_{i+1,j}^{n+1} - 2u_{ij}^{n+1} + u_{i-1,j}^{n+1}\right]  -  r \left[u_{i,j+1}^{n+1} - 2u_{ij}^{n+1} + u_{i,j-1}^{n+1}\right]  +  \frac{i \Delta t}{2} v_{ij} u_{ij}^{n+1} \\
= u_{ij}^n  +  r \left[u_{i+1,j}^n - 2u_{ij}^n + u_{i-1,j}^n\right]  +  r \left[u_{i,j+1}^n - 2u_{ij}^n + u_{i,j-1}^n\right]  -  \frac{i \Delta t}{2} v_{ij} u_{ij}^n,
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(r \equiv \frac{i \Delta t}{2 h^2}\)</span>.</p>
</section>
<section id="problem-2">
<h3>Problem 2<a class="headerlink" href="#problem-2" title="Permalink to this headline">#</a></h3>
<p>One of the tricky things when implementing Crank-Nicolson with two spatial dimensions is getting the matrices and all the different indices right. When taking into account our choice of simple boundary conditions, equation <a class="reference internal" href="#equation-cn-eq1">(25)</a> can be expressed in matrix form as</p>
<div class="math notranslate nohighlight" id="equation-cn-eq2">
<span class="eqno">(26)<a class="headerlink" href="#equation-cn-eq2" title="Permalink to this equation">#</a></span>\[
A \,\vec{u}^{n+1} = B \,\vec{u}^{n}.
\]</div>
<p>Here the vector <span class="math notranslate nohighlight">\(\vec{u}^n\)</span> (and similarly <span class="math notranslate nohighlight">\(\vec{u}^{n+1}\)</span>) is a column vector that contains the <span class="math notranslate nohighlight">\(u^n_{ij}\)</span> values for <em>all the internal points</em> of the <span class="math notranslate nohighlight">\(xy\)</span> grid at time step <span class="math notranslate nohighlight">\(n\)</span>. In row-form it would look like this:</p>
<div class="math notranslate nohighlight">
\[
\vec{u}^n = \left[(u_{1,1}^n, u_{2,1}^n, \ldots, u_{M-2,1}^n), (u_{1,2}^n, u_{2,2}^n, \ldots u_{M-2,2}^n), \ldots, (u_{1,M-2}^n \ldots u_{M-2,M-2}^n)\right].
\]</div>
<p>The parentheses are just added to make it clear where there is a change in the second index <span class="math notranslate nohighlight">\(j\)</span>. Thus the <span class="math notranslate nohighlight">\(\vec{u}\)</span> vectors have length <span class="math notranslate nohighlight">\((M-2)^2\)</span>, and the matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are thus (potentially very large) matrices of size <span class="math notranslate nohighlight">\((M-2)^2 \times (M-2)^2\)</span>.</p>
<p>Now we need some code to help us get this straight in our program:</p>
<ul>
<li><p>Write a code snippet that translates a pair of indices <span class="math notranslate nohighlight">\((i,j)\)</span> into a corresponding single index <span class="math notranslate nohighlight">\(k\)</span> that gives the position of <span class="math notranslate nohighlight">\(u^n_{ij}\)</span> in the vector <span class="math notranslate nohighlight">\(\vec{u}^n\)</span>.</p></li>
<li><p>Start with <span class="math notranslate nohighlight">\((M-2)=3\)</span> as a concrete example and write a code snippet that can take a number <span class="math notranslate nohighlight">\(r\)</span> and two lenght-9 vectors <span class="math notranslate nohighlight">\(\vec{a}\)</span> and <span class="math notranslate nohighlight">\(\vec{b}\)</span> and produce the following matrices:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  A = 
  \begin{bmatrix}
  a_0 &amp;  -r  &amp;  0   &amp;  -r   &amp;   0   &amp;  0    &amp;  0   &amp;  0    &amp;  0    \\
  -r  &amp;  a_1 &amp;  -r  &amp;  0    &amp;   -r  &amp;  0    &amp;  0   &amp;  0    &amp;  0    \\
  0   &amp;  -r  &amp;  a_2 &amp;  0    &amp;   0   &amp;  -r   &amp;  0   &amp;  0    &amp;  0    \\
  -r  &amp;  0   &amp;  0   &amp;  a_3  &amp;   -r  &amp;  0    &amp;  -r  &amp;  0    &amp;  0    \\
  0   &amp;  -r  &amp;  0   &amp;  -r   &amp;   a_4 &amp;  -r   &amp;  0   &amp;  -r   &amp;  0    \\
  0   &amp;  0   &amp;  -r  &amp;  0    &amp;   -r  &amp;  a_5  &amp;  0   &amp;  0    &amp;  -r   \\
  0   &amp;  0   &amp;  0   &amp;  -r   &amp;   0   &amp;  0    &amp;  a_6 &amp;  -r   &amp;  0    \\
  0   &amp;  0   &amp;  0   &amp;  0    &amp;   -r  &amp;  0    &amp;  -r  &amp;  a_7  &amp;  -r   \\
  0   &amp;  0   &amp;  0   &amp;  0    &amp;   0   &amp;  -r   &amp;  0   &amp;  -r   &amp;  a_8  \\
  \end{bmatrix}
  \end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
  B = 
  \begin{bmatrix}
  b_0 &amp;  r   &amp;  0   &amp;  r    &amp;   0   &amp;  0    &amp;  0   &amp;  0    &amp;  0    \\
  r   &amp;  b_1 &amp;  r   &amp;  0    &amp;   r   &amp;  0    &amp;  0   &amp;  0    &amp;  0    \\
  0   &amp;  r   &amp;  b_2 &amp;  0    &amp;   0   &amp;  r    &amp;  0   &amp;  0    &amp;  0    \\
  r   &amp;  0   &amp;  0   &amp;  b_3  &amp;   r   &amp;  0    &amp;  r   &amp;  0    &amp;  0    \\
  0   &amp;  r   &amp;  0   &amp;  r    &amp;   b_4 &amp;  r    &amp;  0   &amp;  r    &amp;  0    \\
  0   &amp;  0   &amp;  r   &amp;  0    &amp;   r   &amp;  b_5  &amp;  0   &amp;  0    &amp;  r    \\
  0   &amp;  0   &amp;  0   &amp;  r    &amp;   0   &amp;  0    &amp;  b_6 &amp;  r    &amp;  0    \\
  0   &amp;  0   &amp;  0   &amp;  0    &amp;   r   &amp;  0    &amp;  r   &amp;  b_7  &amp;  r    \\
  0   &amp;  0   &amp;  0   &amp;  0    &amp;   0   &amp;  r    &amp;  0   &amp;  r    &amp;  b_8  \\
  \end{bmatrix}
  \end{split}\]</div>
<p>If you look closely you will see that the matrix structure is based on submatrices of size <span class="math notranslate nohighlight">\((M-2) \times (M-2)\)</span>. Make sure your code works for a general value of <span class="math notranslate nohighlight">\((M-2)\)</span>, even though we’re testing it for the simple case <span class="math notranslate nohighlight">\((M-2)=3\)</span>.</p>
</li>
<li><p>Now you are ready to write a function for your program that, using inputs <span class="math notranslate nohighlight">\(M\)</span>, <span class="math notranslate nohighlight">\(h\)</span>, <span class="math notranslate nohighlight">\(\Delta t\)</span> and the matrix <span class="math notranslate nohighlight">\(V\)</span> as input, can fill two <span class="math notranslate nohighlight">\((M-2)^2 \times (M-2)^2\)</span> matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> according to the above pattern, with</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  a_k &amp;= 1 + 4r + \frac{i \Delta t}{2} v_{ij},\\
  b_k &amp;= 1 - 4r - \frac{i \Delta t}{2} v_{ij}.
  \end{split}\]</div>
<p>(Here the <span class="math notranslate nohighlight">\(i\)</span> in <span class="math notranslate nohighlight">\(i \Delta t\)</span> is again the imaginary unit.)</p>
</li>
</ul>
</section>
<section id="problem-3">
<h3>Problem 3<a class="headerlink" href="#problem-3" title="Permalink to this headline">#</a></h3>
<p>When we have the matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, finding the next <span class="math notranslate nohighlight">\(\vec{u}^{n+1}\)</span> from the current <span class="math notranslate nohighlight">\(\vec{u}^n\)</span> in a time loop can be done in two steps:</p>
<ol class="simple">
<li><p>Perform the matrix multiplication <span class="math notranslate nohighlight">\(B \, \vec{u}^n = \vec{b}\)</span>.</p></li>
<li><p>Solve the matrix equation <span class="math notranslate nohighlight">\(A \, \vec{u}^{n+1} = \vec{b}\)</span> for the unknown <span class="math notranslate nohighlight">\(\vec{u}^{n+1}\)</span>.</p></li>
</ol>
<p>Given what you know about matrix <span class="math notranslate nohighlight">\(A\)</span>, discuss which approaches might be well-suited to solve <span class="math notranslate nohighlight">\(A \, \vec{u}^{n+1} = \vec{b}\)</span>. For your code you can either implement a solver yourself or use a built-in solver in Armadillo.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to implement your own solver to solve <span class="math notranslate nohighlight">\(A \, \vec{u}^{n+1} = \vec{b}\)</span>, keep in mind that in the lectures we have discussed several different types of methods for solving matrix equations, including some that are easy to implement but that we haven’t used in any previous project…</p>
</div>
</section>
<section id="problem-4">
<h3>Problem 4<a class="headerlink" href="#problem-4" title="Permalink to this headline">#</a></h3>
<p>Write a part of your program that can set up the initial state <span class="math notranslate nohighlight">\(u_{ij}^0\)</span> based on the following expression for an unnormalised Gaussian wave packet</p>
<div class="math notranslate nohighlight">
\[
u(x,y,t=0) = e^{-\frac{(x-x_c)^2}{2 \sigma_x^2} - \frac{(y-y_c)^2}{2 \sigma_y^2} + i p_x (x-x_c) + i p_y (y-y_c)}.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(x_c\)</span> and <span class="math notranslate nohighlight">\(y_c\)</span> are the coordinates of the centre of the initial wave packet, <span class="math notranslate nohighlight">\(\sigma_x\)</span> and <span class="math notranslate nohighlight">\(\sigma_y\)</span> are the initial widths of the wave packet in the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions, and <span class="math notranslate nohighlight">\(p_x\)</span> and <span class="math notranslate nohighlight">\(p_y\)</span> are the wave packet momenta.</p>
<p>Make sure that the initial state <span class="math notranslate nohighlight">\(u_{ij}^0\)</span> satisfies the boundary conditions.</p>
<p>Also, add code that normalizes your initial state such that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\sum\limits_{i,j} u^{0*}_{ij} \, u^0_{ij} = 1,\\
\end{split}\]</div>
<p>i.e. that the total probability in our 2D probability function <span class="math notranslate nohighlight">\(p^n_{ij} = u^{n*}_{ij} \, u^n_{ij}\)</span> starts out normalized to 1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By requiring that <span class="math notranslate nohighlight">\(\sum\limits_{i,j} p^n_{ij} = 1\)</span>, rather than requiring <span class="math notranslate nohighlight">\(\sum\limits_{i,j} p^n_{ij} h^2 = 1\)</span>, we interpret <span class="math notranslate nohighlight">\(p^n_{ij}\)</span> as a <em>probability</em>, not a probability <em>density</em>. That is, <span class="math notranslate nohighlight">\(p^n_{ij}\)</span> is the probability that at time step <span class="math notranslate nohighlight">\(n\)</span> is associated with a small grid cell of area <span class="math notranslate nohighlight">\(h^2\)</span> centered on <span class="math notranslate nohighlight">\((x, y) = (x_i, y_j)\)</span>.</p>
</div>
</section>
<section id="problem-5">
<h3>Problem 5<a class="headerlink" href="#problem-5" title="Permalink to this headline">#</a></h3>
<p>Write a part of your program that initializes the potential <span class="math notranslate nohighlight">\(V\)</span>. To construct the barriers used for the double-slit (and other configurations) we will simply set the elements <span class="math notranslate nohighlight">\(v_{ij}\)</span> of <span class="math notranslate nohighlight">\(V\)</span> that correspond to points inside the barriers to some high constant value <span class="math notranslate nohighlight">\(v_{ij} = v_0\)</span>. As our starting point we will use the following double-slit setup:</p>
<ul class="simple">
<li><p>Wall thickness in the <span class="math notranslate nohighlight">\(x\)</span> direction: 0.02</p></li>
<li><p>Wall position (centre) in the <span class="math notranslate nohighlight">\(x\)</span> direction: 0.5</p></li>
<li><p>Length of the wall piece separating the two slits (the <span class="math notranslate nohighlight">\(y\)</span> distance between the inner edges of the two slits): 0.05</p></li>
<li><p>Slit aperture (opening in the <span class="math notranslate nohighlight">\(y\)</span> direction): 0.05</p></li>
<li><p>Ensure that the slit setup is symmetric around <span class="math notranslate nohighlight">\(y = 0.5\)</span>. (So for the double-slit, the wall piece separating the two slits should be centered on <span class="math notranslate nohighlight">\(y = 0.5\)</span>.)</p></li>
</ul>
<p>In Problem 9 you will also use single-slit and triple-slit configurations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to simulate new potential configurations without having to hard-code the potentials in your program or specify a very long list of command-line arguments, you can consider using an input text file to specify the potential configuration. See the <a class="reference internal" href="../introduction_to_cpp/intro_to_armadillo.html#sec-intro-to-armadillo"><span class="std std-ref">introduction to Armadillo</span></a> page for an easy example of how to read a text data table with Armadillo, or take a look at the <a class="reference internal" href="../introduction_to_cpp/read_from_file.html#sec-read-from-file"><span class="std std-ref">read from file</span></a> page for an example using only the standard C++ library.</p>
</div>
</section>
<section id="problem-6">
<h3>Problem 6<a class="headerlink" href="#problem-6" title="Permalink to this headline">#</a></h3>
<p>Put everything together into a program that does (at least) the following:</p>
<ol class="simple">
<li><p>Set the simulation parameters. It may be useful to read some or all of these as command-line input, or from an input file. The main simulation parameters are <span class="math notranslate nohighlight">\(h\)</span>, <span class="math notranslate nohighlight">\(\Delta t\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(x_c\)</span>, <span class="math notranslate nohighlight">\(\sigma_x\)</span>, <span class="math notranslate nohighlight">\(p_x\)</span>, <span class="math notranslate nohighlight">\(y_c\)</span>, <span class="math notranslate nohighlight">\(\sigma_y\)</span>, <span class="math notranslate nohighlight">\(p_y\)</span> and <span class="math notranslate nohighlight">\(v_0\)</span>.</p></li>
<li><p>Set up the potential matrix, <span class="math notranslate nohighlight">\(V\)</span>.</p></li>
<li><p>Set up the initial state matrix, <span class="math notranslate nohighlight">\(U^0\)</span>.</p></li>
<li><p>Set up the matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> required by the Crank-Nicolson approach.</p></li>
<li><p>Run the loop over time steps and store each new state <span class="math notranslate nohighlight">\(U^n\)</span>. You can either write every new state directly to file during the loop, or store them in memory and write everything to file after the loop. (Armadillo’s <code class="docutils literal notranslate"><span class="pre">cx_cube</span></code> might be useful.)</p></li>
</ol>
</section>
<section id="problem-7">
<h3>Problem 7<a class="headerlink" href="#problem-7" title="Permalink to this headline">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that for this problem the output file can become large-ish (~200MB as binary file) if you save the full simulation, i.e. the full wave function at each time step.</p>
</div>
<p>In theory, the total probability (<span class="math notranslate nohighlight">\(= 1\)</span>) in the probability function <span class="math notranslate nohighlight">\(p^n_{ij} = u^{n*}_{ij}\,u^n_{ij}\)</span> should be conserved over time. This is a nice consistency check to make sure your code works as it should.</p>
<ul class="simple">
<li><p>First run your simulation with the settings <span class="math notranslate nohighlight">\(h = 0.005\)</span>, <span class="math notranslate nohighlight">\(\Delta t = 2.5\times10^{-5}\)</span>, <span class="math notranslate nohighlight">\(T = 0.008\)</span>, <span class="math notranslate nohighlight">\(x_c = 0.25\)</span>, <span class="math notranslate nohighlight">\(\sigma_x = 0.05\)</span>, <span class="math notranslate nohighlight">\(p_x = 200\)</span>, <span class="math notranslate nohighlight">\(y_c = 0.5\)</span>, <span class="math notranslate nohighlight">\(\sigma_y = 0.05\)</span>, <span class="math notranslate nohighlight">\(p_y = 0\)</span> and <span class="math notranslate nohighlight">\(v_0 = 0\)</span>, i.e. without any double-slit barrier.</p></li>
<li><p>Make a plot of the deviation of the total probability from 1.0 as a function of time. (If the deviations are too small to be visible in your plot, consider plotting the data in a different way…)</p></li>
<li><p>Run the simulation again, but now with a double-slit barrier switched on. Use <span class="math notranslate nohighlight">\(v_0 = 1\times10^{10}\)</span> and the double-slit configuration from Problem 5, and make the initial state broader in the <span class="math notranslate nohighlight">\(y\)</span>-direction by setting <span class="math notranslate nohighlight">\(\sigma_y = 0.10\)</span>.</p></li>
<li><p>Make a similar plot of the deviation of the total probability from 1.0 as a function of time.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep in mind that how accurately you should expect the probability to be conserved will depend on what type of approach you have chosen for solving the matrix equation in Problem 3.</p>
</div>
</section>
<section id="problem-8">
<h3>Problem 8<a class="headerlink" href="#problem-8" title="Permalink to this headline">#</a></h3>
<p>Run your simulation with the following settings: <span class="math notranslate nohighlight">\(h = 0.005\)</span>, <span class="math notranslate nohighlight">\(\Delta t = 2.5\times10^{-5}\)</span>, <span class="math notranslate nohighlight">\(T = 0.002\)</span>, <span class="math notranslate nohighlight">\(x_c = 0.25\)</span>, <span class="math notranslate nohighlight">\(\sigma_x = 0.05\)</span>, <span class="math notranslate nohighlight">\(p_x = 200\)</span>, <span class="math notranslate nohighlight">\(y_c = 0.5\)</span>, <span class="math notranslate nohighlight">\(\sigma_y = 0.20\)</span>, <span class="math notranslate nohighlight">\(p_y = 0\)</span> and <span class="math notranslate nohighlight">\(v_0 = 1\times10^{10}\)</span>. Use the double-slit configuration from Problem 5.</p>
<ul class="simple">
<li><p>Make three colourmap plots that illustrate the time evolution of the 2D probability function <span class="math notranslate nohighlight">\(p^n_{ij} = u^{n*}_{ij}\,u^n_{ij}\)</span>. Use the times <span class="math notranslate nohighlight">\(t = 0\)</span>, <span class="math notranslate nohighlight">\(t = 0.001\)</span> and <span class="math notranslate nohighlight">\(t = 0.002\)</span>. (Feel free to make more plots if you want, but at least include these time steps.)</p></li>
<li><p>For the same time steps, also make colourmap plots that show <span class="math notranslate nohighlight">\(\text{Re}(u_{ij})\)</span> and <span class="math notranslate nohighlight">\(\text{Im}(u_{ij})\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When making the colourmap plots, it may be a good idea adjust the colour scale to the maximum of <span class="math notranslate nohighlight">\(p^n_{ij}\)</span> at each time step independently. Then you avoid the problem that the shape of the probability function becomes difficult to see for time steps where it is very broad and flat.</p>
<p>You may also consider not using <span class="math notranslate nohighlight">\(p^n_{ij}\)</span> as the <span class="math notranslate nohighlight">\(z\)</span> axis (colour) value, but rather some tranformation of <span class="math notranslate nohighlight">\(p^n_{ij}\)</span> like <span class="math notranslate nohighlight">\(\sqrt{p^n_{ij}}\)</span>, to more clearly see the structures in the low-probability regions. However, this comes with the cost that the plots become somewhat harder to interpret. But regardless of your choice, make sure to specify exactly what quantity the values on the colour scale represent.</p>
</div>
</section>
<section id="problem-9">
<h3>Problem 9<a class="headerlink" href="#problem-9" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>Assume that we measure the particle with a detector screen at <span class="math notranslate nohighlight">\(x = 0.8\)</span> (spanning the entire <span class="math notranslate nohighlight">\(y\)</span> axis) at time <span class="math notranslate nohighlight">\(t = 0.002\)</span>. Using your simulation results from Problem 8, make a plot that shows the detection probability along this screen at this time.</p>
<p>Since we assume that we do indeed detect the particle <em>somewhere</em> along this line, you should normalise the one-dimensional probability function to sum to 1.0. Or in other words, you should plot <span class="math notranslate nohighlight">\(p(y\,|\,x=0.8\,;\,t=0.002)\)</span>, not <span class="math notranslate nohighlight">\(p(x,y\,;\,t=0.002)\)</span> along <span class="math notranslate nohighlight">\(x=0.8\)</span>.</p>
</li>
<li><p>Adjust your code to also simulate single-slit and triple-slit experiments. Like for the double-slit case, use slits with aperture 0.05 and use walls of <span class="math notranslate nohighlight">\(y\)</span>-length 0.05 to separate each pair of slits (in the triple-slit case). For each case, make a plot of the same 1D probability function as above, i.e. <span class="math notranslate nohighlight">\(p(y\,|\,x=0.8\,;\,t=0.002)\)</span>.</p></li>
</ul>
</section>
<section id="problem-x">
<h3>Problem X<a class="headerlink" href="#problem-x" title="Permalink to this headline">#</a></h3>
<p>If you find it useful, feel free to make some animations of your simulation and put links to these in your report! (However, don’t overdo it — your report will be more readable if the reader doesn’t have to switch between the report and watching animations all the time.)</p>
</section>
<hr class="docutils" />
<section id="code-snippets">
<h3>Code snippets<a class="headerlink" href="#code-snippets" title="Permalink to this headline">#</a></h3>
<p>Here’s a python example demonstrating how you can use matplotlib to animate 2D colourmap plots:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>


<span class="c1">#</span>
<span class="c1"># Let&#39;s generate a dummy time series for a function z(x,y,t)</span>
<span class="c1">#</span>

<span class="c1"># Set up a 2D xy grid</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">x_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">y_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">y_points</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Array of time points</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">t_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># A function for a Gaussian that is travelling </span>
<span class="c1"># in the x direction and broadening as time passes</span>
<span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">sigma_x</span> <span class="o">=</span> <span class="mf">0.025</span> <span class="o">+</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma_x</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_c</span> <span class="o">-</span> <span class="n">v</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">sigma_x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Fill z_data_list with f(x,y,t)</span>
<span class="n">z_data_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_points</span><span class="p">:</span>
    <span class="n">z_data</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">z_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_data</span><span class="p">)</span>


<span class="c1">#</span>
<span class="c1"># Now the list z_data_list contains a series of &quot;frames&quot; of z(x,y,t), </span>
<span class="c1"># where each frame can be plotted as a 2D image using imshow. Let&#39;s</span>
<span class="c1"># animate it!</span>
<span class="c1">#</span>

<span class="c1"># Some settings</span>
<span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">t_min</span> <span class="o">=</span> <span class="n">t_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">x_points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">y_points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="c1"># Create a colour scale normalization according to the max z value in the first frame</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z_data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Plot the first frame</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">z_data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">x_min</span><span class="p">,</span><span class="n">x_max</span><span class="p">,</span><span class="n">y_min</span><span class="p">,</span><span class="n">y_max</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

<span class="c1"># Axis labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

<span class="c1"># Add a colourbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;z(x,y,t)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

<span class="c1"># Add a text element showing the time</span>
<span class="n">time_txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s2">&quot;t = </span><span class="si">{:.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t_min</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> 
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

<span class="c1"># Function that takes care of updating the z data and other things for each frame</span>
<span class="k">def</span> <span class="nf">animation</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="c1"># Normalize the colour scale to the current frame?</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z_data_list</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">img</span><span class="o">.</span><span class="n">set_norm</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>

    <span class="c1"># Update z data</span>
    <span class="n">img</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">z_data_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># Update the time label</span>
    <span class="n">current_time</span> <span class="o">=</span> <span class="n">t_min</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">time_txt</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;t = </span><span class="si">{:.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">current_time</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">img</span>

<span class="c1"># Use matplotlib.animation.FuncAnimation to put it all together</span>
<span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animation</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_data_list</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Run the animation!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># # Save the animation</span>
<span class="c1"># anim.save(&#39;./animation.mp4&#39;, writer=&quot;ffmpeg&quot;, bitrate=-1, fps=30)</span>
</pre></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/projects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="project4.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Project 4</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By the FYS3150 teaching team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>